"use strict";(self.webpackChunk_glitchjsy_data_frontend=self.webpackChunk_glitchjsy_data_frontend||[]).push([[2465],{6684:(e,t,a)=>{a.d(t,{c:()=>d,A:()=>m});var n=a(6540);const l={loadingOrFailed:"loadingOrFailed_NuqP",loading:"loading_PwrK",failed:"failed_Xr5a",fullscreen:"fullscreen_VAEq",footer:"footer_gakN",toolbarButton:"toolbarButton_Uwut",toolbar:"toolbar_tpzs",viewTypeWrapper:"viewTypeWrapper_Al25",datePickerWrapper:"datePickerWrapper_EUWW",spinner:"spinner_w5sl",spin:"spin_l4i9"};var r=a(9386),s=a.n(r),c=(a(1180),a(53)),o=a(8027),i=a(1578);let d=function(e){return e[e.Loading=0]="Loading",e[e.Loaded=1]="Loaded",e[e.Failed=2]="Failed",e}({});function m(e){const[t,a]=(0,n.useState)(!1),[r,m]=(0,n.useState)(!1),u=()=>{m(!0),setTimeout((()=>{m(!1),e.onRetry()}),200)};if(e.state===d.Loading||r)return n.createElement("div",{className:(0,c.A)(l.loadingOrFailed,l.loading)},n.createElement("div",{className:l.spinner}),n.createElement("p",null,"Loading ",e.title," chart..."));if(e.state===d.Failed)return n.createElement("div",{className:(0,c.A)(l.loadingOrFailed,l.failed)},n.createElement("p",null,"Failed to load data for ",e.title," chart"),n.createElement("button",{className:"btn btn-primary",onClick:u},"Retry"));return n.createElement("div",{className:t?l.fullscreen:void 0},n.createElement("div",{className:l.toolbar},e.enableViewMode&&e.viewMode&&e.onViewModeChange&&n.createElement("div",{className:l.viewTypeWrapper},n.createElement("button",{onClick:()=>e.onViewModeChange("all"),disabled:"all"===e.viewMode},"All"),n.createElement("button",{onClick:()=>e.onViewModeChange("monthly"),disabled:"monthly"===e.viewMode},"Monthly"),n.createElement("button",{onClick:()=>e.onViewModeChange("yearly"),disabled:"yearly"===e.viewMode},"Yearly")),e.enableDateControls&&n.createElement("div",{className:l.datePickerWrapper},e.onPrev&&n.createElement("button",{onClick:e.onPrev},"<"),e.onNext&&n.createElement("button",{onClick:e.onNext},">"),e.onDateChange&&n.createElement(s(),{selected:e.selectedDate,onChange:e.onDateChange,dateFormat:e.datePickerIsMonthsOnly?"MMM yyyy":"dd MMM yyyy",showMonthYearPicker:e.datePickerIsMonthsOnly}))),e.children,n.createElement("div",{className:l.footer},n.createElement("button",{className:l.toolbarButton,onClick:()=>a(!t)},t?n.createElement(n.Fragment,null,n.createElement(i.GWt,null)," Exit Fullscreen"):n.createElement(n.Fragment,null,n.createElement(o._AH,null)," Fullscreen")),n.createElement("button",{className:l.toolbarButton,onClick:()=>{const e=document.querySelector("canvas");if(e){const t=document.createElement("a");t.href=e.toDataURL("image/png"),t.download="chart.png",t.click()}}},n.createElement(o.dIn,null)," Save Image")))}},2760:(e,t,a)=>{a.d(t,{A:()=>y});var n=a(6540),l=a(2898),r=a(3551),s=a(7559),c=a(3975),o=a(53);const i=[{type:"link",label:"Dashboard",href:"/admin"},{type:"link",label:"Users",href:"/admin/users"},{type:"link",label:"API Keys",href:"/admin/api-keys"}];function d(){return n.createElement("aside",{className:(0,o.A)(s.G.docs.docSidebarContainer,r.A.docSidebarContainer)},n.createElement(c.A,{sidebar:i,path:"/charts",onCollapse:function(){throw new Error("Function not implemented.")},isHidden:!1}))}var m=a(5976),u=a(3042),p=a(7346),E=a(5549);const h={adminHeader:"adminHeader_O0l7"},b={page:"page_zoQh"};function g(){return n.createElement(E.A,{title:"Not authorized"},n.createElement("div",{className:b.page},n.createElement("h1",null,"Not Authorized"),n.createElement("p",null,"You are not authorized to access this page")))}function y(e){let{children:t,title:a,subCategory:r}=e;const[c,i]=(0,n.useState)(!1);(0,n.useEffect)((()=>{b()}),[]);const b=async()=>{try{const e=await fetch("https://data-api.glitch.je/me/session",{credentials:"include"}),t=await e.json();t&&t.user?.siteAdmin?i(!0):i(!1)}catch{i(!1)}};return c?n.createElement(E.A,{title:a},n.createElement("div",{className:h.adminHeader},"Admin Area"),n.createElement("div",{className:l.A.docPage},n.createElement(d,null),n.createElement("main",{className:(0,o.A)(p.A.docMainContainer)},n.createElement("div",{className:(0,o.A)("container","padding-top--md","padding-bottom--lg")},n.createElement("div",{className:m.A.docItemContainer},n.createElement("article",null,n.createElement("nav",{className:u.A.breadcrumbsContainer},n.createElement("ul",{className:"breadcrumbs"},r&&n.createElement("li",{className:"breadcrumbs__item"},n.createElement("a",{className:"breadcrumbs__link"},r)),n.createElement("li",{className:"breadcrumbs__item breadcrumbs__item--active"},n.createElement("span",{className:"breadcrumbs__link"},a),n.createElement("meta",{itemProp:"position",content:"2"})))),n.createElement("div",{className:(0,o.A)(s.G.docs.docMarkdown,"marldown")},t))))))):n.createElement(g,null)}},8708:(e,t,a)=>{a.r(t),a.d(t,{default:()=>u});var n=a(2760),l=a(6540);const r={statsWrapper:"statsWrapper_CmEy"},s={stat:"stat_vpMA",name:"name_X04S",value:"value_qyDm"};function c(e){let{name:t,value:a}=e;return l.createElement("div",{className:s.stat},l.createElement("div",{className:s.name},t),l.createElement("div",{className:s.value},a))}var o=a(6684),i=a(4731),d=a(2022);function m(){const[e,t]=(0,l.useState)({}),[a,n]=(0,l.useState)(new Date),[r,s]=(0,l.useState)(!1),[c,d]=(0,l.useState)(o.c.Loading),m=async e=>{try{s(!1);let a="https://data-api.glitch.je/admin/stats/daily-requests";if(e){const t=e.getMonth()+1;a+=`?month=${t}&year=${e.getFullYear()}`}const n=await fetch(a,{credentials:"include"}),l=(await n.json()).results;t(l),s(!0)}catch(a){console.error("Error fetching chart data:",a),s(!1)}};(0,l.useEffect)((()=>{m(a)}),[]),(0,l.useEffect)((()=>{if(r){const a=e.map((e=>e.day)),n=e.map((e=>parseInt(e.total)));t({labels:a,datasets:[{label:"API Requests",data:n,borderColor:"green",backgroundColor:"green",fill:!1,tension:.4}]}),d(o.c.Loaded)}}),[r]);return l.createElement(o.A,{title:"API Requests",state:c,onRetry:()=>m(a),enableDateControls:!0,selectedDate:a,datePickerIsMonthsOnly:!0,onDateChange:e=>{e&&(n(e),m(e))},onPrev:()=>{const e=new Date(a);e.setMonth(e.getMonth()-1),n(e),m(e)},onNext:()=>{const e=new Date(a);e.setMonth(e.getMonth()+1),n(e),m(e)}},l.createElement(i.N1,{data:e,options:{responsive:!0,plugins:{legend:{position:"top"},title:{display:!0,text:"API Requests per Day"}},scales:{x:{title:{display:!0,text:"Date"}},y:{title:{display:!0,text:"Requests"},beginAtZero:!0}}}}))}function u(){const[e,t]=(0,l.useState)(""),a=async()=>{try{const e=await fetch("https://data-api.glitch.je/admin/stats",{credentials:"include"}),a=(await e.json()).results;t(a.apiUptime)}catch(e){console.error("Error fetching stats:",e)}};return(0,l.useEffect)((()=>{a();const e=setInterval((()=>a()),1e3);return()=>clearInterval(e)}),[]),l.createElement(n.A,{title:"Dashboard"},l.createElement("h1",null,"Dashboard"),l.createElement("div",{className:r.statsWrapper},l.createElement(c,{name:"API Uptime",value:e})),l.createElement("div",{style:{marginTop:"20px"}},l.createElement(m,null)))}d.t1.register(d.PP,d.kc,d.FN,d.No,d.hE,d.m_,d.s$)}}]);