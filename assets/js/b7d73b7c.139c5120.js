"use strict";(self.webpackChunk_glitchjsy_data_frontend=self.webpackChunk_glitchjsy_data_frontend||[]).push([[7264],{52760:(e,t,a)=>{a.d(t,{A:()=>f});var n=a(96540),r=a(2898),l=a(93551),c=a(17559),s=a(93975),o=a(20053);const i=[{type:"link",label:"Dashboard",href:"/admin"},{type:"link",label:"Users",href:"/admin/users"},{type:"link",label:"API Keys",href:"/admin/api-keys"}];function m(){return n.createElement("aside",{className:(0,o.A)(c.G.docs.docSidebarContainer,l.A.docSidebarContainer)},n.createElement(s.A,{sidebar:i,path:"/charts",onCollapse:function(){throw new Error("Function not implemented.")},isHidden:!1}))}var d=a(5976),u=a(3042),E=a(37346),y=a(15549);const p={adminHeader:"adminHeader_O0l7"},h={page:"page_zoQh"};function b(){return n.createElement(y.A,{title:"Not authorized"},n.createElement("div",{className:h.page},n.createElement("h1",null,"Not Authorized"),n.createElement("p",null,"You are not authorized to access this page")))}var A=a(99571);function f(e){let{children:t,title:a,subCategory:l}=e;const[s,i]=(0,n.useState)(!1);(0,n.useEffect)((()=>{h()}),[]);const h=async()=>{try{const e=await fetch("https://api.opendata.je/me/session",{credentials:"include"}),t=await e.json();t&&t.user?.siteAdmin?i(!0):i(!1)}catch{i(!1)}};return s?n.createElement(y.A,{title:a},n.createElement("div",{className:p.adminHeader},"Admin Area"),n.createElement("div",{className:r.A.docPage},n.createElement(m,null),n.createElement("main",{className:(0,o.A)(E.A.docMainContainer)},n.createElement("div",{className:(0,o.A)("container","padding-top--md","padding-bottom--lg")},n.createElement("div",{className:d.A.docItemContainer},n.createElement("article",null,n.createElement("nav",{className:u.A.breadcrumbsContainer},n.createElement("ul",{className:"breadcrumbs"},l&&n.createElement("li",{className:"breadcrumbs__item"},n.createElement("a",{className:"breadcrumbs__link"},l)),n.createElement("li",{className:"breadcrumbs__item breadcrumbs__item--active"},n.createElement("span",{className:"breadcrumbs__link"},a),n.createElement("meta",{itemProp:"position",content:"2"})))),n.createElement("div",{className:(0,o.A)(c.G.docs.docMarkdown,"marldown")},t)))))),n.createElement(A.N9,null)):n.createElement(b,null)}},46325:(e,t,a)=>{a.d(t,{A:()=>l});var n=a(58168),r=a(96540);function l(e){let{gap:t,direction:a="row",children:l,...c}=e;return r.createElement("div",(0,n.A)({style:{display:"flex",gap:t,flexDirection:a}},c),l)}},26414:(e,t,a)=>{a.d(t,{A:()=>o});var n=a(58168),r=a(96540),l=a(95293),c=a(20053);const s={button:"button_h_xa",smallerPadding:"smallerPadding_avZr",primary:"primary_UmVR",secondary:"secondary_amWm",danger:"danger_jN6b"};function o(e){let{children:t,variant:a="primary",useSmallerPadding:o,className:i,...m}=e;const{colorMode:d}=(0,l.G)();return r.createElement("button",(0,n.A)({className:(0,c.A)(s.button,s[a],{[s.smallerPadding]:o},i),"data-theme":d},m),t)}},4334:(e,t,a)=>{a.d(t,{b:()=>o});var n=a(96540),r=a(95293);const l={tableWrapper:"tableWrapper_GFu2",table:"table_L05C"};var c=a(26414),s=a(39197);function o(e){let{columns:t,data:a,onReload:o}=e;const{colorMode:i}=(0,r.G)();return n.createElement("div",{className:l.tableWrapper,"data-theme":i},n.createElement("table",{className:l.table},n.createElement("thead",null,n.createElement("tr",null,t.map((e=>n.createElement("th",{key:e.key},e.header))))),n.createElement("tbody",null,a.map((e=>n.createElement("tr",{key:e.id},t.map((t=>n.createElement("td",{key:t.key},t.render?t.render(e):e[t.key])))))))),n.createElement(c.A,{variant:"secondary",useSmallerPadding:!0,onClick:()=>o()},n.createElement(s.BVQ,{style:{marginRight:"6px"}})," Reload"))}},45591:(e,t,a)=>{a.d(t,{A:()=>l});var n=a(96540);const r={formGroup:"formGroup_YCak"};function l(e){return n.createElement("div",{className:r.formGroup},n.createElement("label",null,e.label),e.children)}},39063:(e,t,a)=>{a.d(t,{A:()=>s});var n=a(96540),r=a(20312),l=a.n(r);const c={overlay:"overlay_hsb3",content:"content_L2fA",close:"close_fKGm",title:"title__v93",body:"body_gKmW"};function s(e){let{isOpen:t,onClose:a,title:r,children:s}=e;return n.createElement(l(),{isOpen:t,onRequestClose:a,overlayClassName:c.overlay,className:c.content},n.createElement("button",{className:c.close,onClick:a},"\xd7"),r&&n.createElement("h2",{className:c.title},r),n.createElement("div",{className:c.body},s))}},65228:(e,t,a)=>{a.r(t),a.d(t,{default:()=>u});var n=a(52760),r=a(46325),l=a(26414),c=a(4334),s=a(45591),o=a(39063),i=a(51107),m=a(96540),d=a(39197);function u(){const[e,t]=(0,m.useState)([]),[a,s]=(0,m.useState)(!1);(0,m.useEffect)((()=>{o()}),[]);const o=async()=>{try{const e=await fetch("https://api.opendata.je/admin/tokens",{credentials:"include"});t((await e.json()).results)}catch(e){console.error("Error fetching API keys:",e)}};return m.createElement(n.A,{title:"API Keys"},m.createElement(i.A,{as:"h1"},"API Keys"),m.createElement(l.A,{variant:"primary",style:{marginBottom:"20px"},onClick:()=>s(!0)},"Create API Key"),m.createElement(c.b,{data:e,onReload:()=>o(),columns:[{key:"userEmail",header:"User"},{key:"createdAt",header:"Joined",render:e=>new Date(e.createdAt).toLocaleDateString("en-GB",{year:"numeric",month:"long",day:"numeric"})},{key:"token",header:"Key"},{key:"summary",header:"Summary"},{key:"actions",header:"",render:e=>m.createElement(r.A,{gap:"6px"},m.createElement(l.A,{useSmallerPadding:!0,variant:"secondary",onClick:()=>alert(e.id)},m.createElement(d.ELu,null)),m.createElement(l.A,{useSmallerPadding:!0,variant:"danger",onClick:()=>(async e=>{try{confirm("Are you sure you want to delete this API key?")&&(await fetch(`https://api.opendata.je/admin/tokens/${e.id}`,{method:"DELETE",credentials:"include"}),window.location.reload())}catch(t){console.error("Error deleting API key:",t)}})(e)},m.createElement(d.G02,null)))}]}),m.createElement(E,{isOpen:a,onClose:()=>s(!1)}))}function E(e){let{isOpen:t,onClose:a}=e;const[n,r]=(0,m.useState)(""),[c,i]=(0,m.useState)(""),[d,u]=(0,m.useState)([]);(0,m.useEffect)((()=>{r(""),i(""),E()}),[t]);const E=async()=>{try{const e=await fetch("https://api.opendata.je/admin/users",{credentials:"include"});u((await e.json()).results)}catch(e){console.error("Error fetching users:",e)}};return m.createElement(o.A,{isOpen:t,onClose:a,title:"Create API Key"},m.createElement(s.A,{label:"Summary"},m.createElement("input",{type:"text",value:c,maxLength:200,onChange:e=>i(e.target.value)})),m.createElement(s.A,{label:"User"},m.createElement("select",{value:n,onChange:e=>r(e.target.value)},m.createElement("option",{value:"null"},"Please select a user"),d.map((e=>m.createElement("option",{key:e.id,value:e.id},e.email))))),m.createElement(l.A,{variant:"secondary",onClick:()=>(async()=>{try{if(""===n||"null"===n)return;await fetch("https://api.opendata.je/admin/tokens/new",{method:"POST",credentials:"include",body:JSON.stringify({userId:n,summary:c})}),a(),window.location.reload()}catch(e){console.error("Error creating API key:",e)}})()},"Create"))}}}]);