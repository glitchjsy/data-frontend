"use strict";(self.webpackChunk_glitchjsy_data_frontend=self.webpackChunk_glitchjsy_data_frontend||[]).push([[868],{8976:(e,t,a)=>{a.d(t,{A:()=>s});var l=a(8168),n=a(6540),r=a(7330),c=a(8272);function i(e){const[t,a]=(0,n.useState)(e.initialViewport),[i,o]=(0,n.useState)(null);return n.createElement("div",{style:{display:"flex",justifyContent:"center"}},n.createElement(r.Ay,(0,l.A)({},t,{mapStyle:"mapbox://styles/mapbox/streets-v11",onViewportChange:e=>a(e),mapboxApiAccessToken:c.R}),n.createElement(r.ov,{showZoom:!0,style:{padding:"20px",zIndex:1e4}}),e.locations.map(((t,a)=>n.createElement(r.pH,(0,l.A)({key:a,latitude:Number(t.latitude),longitude:Number(t.longitude),onClick:()=>o(t)},e.markerProps),e.marker(t)))),e.popup&&i&&n.createElement(r.zD,(0,l.A)({latitude:i.latitude,longitude:i.longitude,onClose:()=>o(null),className:"mapbox-popup"},e.popupProps),e.popup(i))))}const o={loadingWrapper:"loadingWrapper_rIiJ"};function s(e){const[t,a]=(0,n.useState)([]),[r,c]=(0,n.useState)("loading");return(0,n.useEffect)((()=>{e.item.fetchData().then((e=>{a(e),c("loaded")})).catch((e=>c("failed")))}),[]),"loading"===r?n.createElement("div",{className:o.loadingWrapper},n.createElement("p",null,"Loading...")):"failed"===r?n.createElement("div",{className:o.loadingWrapper},n.createElement("p",null,"Failed to load map data")):n.createElement(i,(0,l.A)({initialViewport:{width:"100%",height:"400px",latitude:49.214198,longitude:-2.132497,zoom:11},locations:t,marker:t=>e.item.icon(t),popup:t=>e.item.popup(t)},e))}},7861:(e,t,a)=>{a.d(t,{Z:()=>T});var l=a(6540);const n="popup_P_2S",r="popupName_aI73";function c(e){let{location:t}=e;return l.createElement("div",{className:n},l.createElement("p",{className:r},t.name))}const i="popup_5RKj",o="popupName_ihZz";function s(e){let{location:t}=e;return l.createElement("div",{className:i},l.createElement("p",{className:o},t.name))}function p(e){let{location:t}=e;const[a,n]=(0,l.useState)("transparent"),[r,c]=(0,l.useState)(!1),i={border:"2px solid",borderColor:a,height:"25px"};return(0,l.useEffect)((()=>{null!==t.owner?.id&&(c(!0),"6060f60d-17a1-49c8-aa4a-c268721a806a"===t.owner.id&&n("red"),"62a13258-686c-456c-87f3-8a93ff735d35"===t.owner.id&&n("blue"),"52c49647-20f2-49f0-b9b6-a9ba49a13d03"===t.owner.id&&n("orange"))}),[t]),l.createElement("div",{style:r?i:{}},l.createElement("img",{src:"/img/maps/toilet.png",height:"20",width:"20"}))}function m(e){let{location:t}=e;return l.createElement("img",{src:"/img/maps/recycling.png",height:"20",width:"20"})}function u(e){let{location:t}=e;return l.createElement("img",{src:`/img/maps/eatsafe-${t.rating}.png`,height:"20",width:"20",style:{backgroundColor:"white",borderRadius:"50%"}})}const d={popup:"popup_YQy9",popupName:"popupName_U7DZ",popupType:"popupType_kaXW",popupList:"popupList_RGla",facilitiesWrapper:"facilitiesWrapper_vcKX",facility:"facility_z7_y",popupParish:"popupParish_IEy8",toiletGrid:"toiletGrid_keSm",toiletItem:"toiletItem_Sap9",ownedBy:"ownedBy_yMNL"};function E(e){let{location:t}=e;const a=l.createElement("span",{style:{color:"red"}},"N/A");return l.createElement("div",{className:d.popup},l.createElement("p",{className:d.popupName},t.name),l.createElement("p",{className:d.popupParish},t.parish," ",t.buildDate&&`| Built in ${t.buildDate}`),l.createElement("div",{className:d.facilitiesWrapper},t.facilities.map((e=>l.createElement("p",{className:d.facility},e)))),l.createElement("div",{className:d.toiletGrid},l.createElement("div",{className:d.maleToilet},l.createElement("strong",null,"Male"),t.male?l.createElement(l.Fragment,null,l.createElement("p",{className:d.toiletItem},"Cubicles: ",t.male.cubicles??a),l.createElement("p",{className:d.toiletItem},"Urinals: ",t.male.urinales??a),l.createElement("p",{className:d.toiletItem},"Hand Dryers: ",t.male.handDryers??a),l.createElement("p",{className:d.toiletItem},"Sinks: ",t.male.sinks??a)):l.createElement("p",null,"No male toilets")),l.createElement("div",{className:d.femaleToilet},l.createElement("strong",null,"Female"),t.female?l.createElement(l.Fragment,null,l.createElement("p",{className:d.toiletItem},"Cubicles: ",t.female.cubicles??a),l.createElement("p",{className:d.toiletItem},"Hand Dryers: ",t.female.handDryers??a),l.createElement("p",{className:d.toiletItem},"Sinks: ",t.female.sinks??a)):l.createElement("p",null,"No female toilets")),t.owner&&l.createElement("p",{className:d.ownedBy},"Owned by ",t.owner.name)))}function g(e){let{location:t}=e;return l.createElement("img",{src:"/img/maps/defib.png",height:"20",width:"20"})}const h="popup_v_lW",f="popupAddress_O2pV",b="popupParish_EZZs",y="popupPadNumber_VObk",N="popupNotes_kSdB";function k(e){let{location:t}=e;return l.createElement("div",{className:h},l.createElement("p",{className:f},t.address),l.createElement("p",{className:b},t.parish),l.createElement("p",{className:y},t.padNumber),t.notes&&l.createElement("p",{className:N},t.notes))}function w(e){let{location:t}=e;return l.createElement("img",{src:t.shelter?"/img/maps/bus-stop-yellow.png":"/img/maps/bus-stop.png",height:"20",width:"20"})}const S="popup_mXuE",_="popupName_azMX";function v(e){let{location:t}=e;return l.createElement("div",{className:S},l.createElement("p",{className:_},t.name))}function C(e){let{location:t}=e;return l.createElement("img",{src:"/img/maps/carpark.png",height:"20",width:"20"})}const D="popup_oaBH",A="popupName_jxds",I="popupType_pGU4",j="popupList_pjIE";function B(e){let{location:t}=e;return l.createElement("div",{className:D},l.createElement("p",{className:A},t.name),l.createElement("p",{className:I},(()=>{switch(t.type){case"LONG_STAY":return"Long Stay";case"SHORT_STAY":return"Short Stay";case"UNKNOWN":return"Unknown"}return t.type})()),l.createElement("ul",{className:j},l.createElement("li",null,l.createElement("strong",null,"Surface: "),t.surfaceType),l.createElement("li",null,l.createElement("strong",null,"Spaces:")," ",t.spaces),l.createElement("li",null,l.createElement("strong",null,"Disabled Spaces:")," ",t.disabledSpaces),l.createElement("li",null,l.createElement("strong",null,"Parent/Child Spaces:")," ",t.parentChildSpaces),l.createElement("li",null,l.createElement("strong",null,"Electric Charging Spaces:")," ",t.electricChargingSpaces)))}const T={eatsafe:{label:"Eatsafe ratings",icon:e=>l.createElement(u,{location:e}),popup:e=>l.createElement(c,{location:e}),fetchData:()=>x("eatsafe")},recycling:{label:"Recycling centres",icon:e=>l.createElement(m,{location:e}),popup:e=>l.createElement(s,{location:e}),fetchData:()=>x("recycling")},toilet:{label:"Public toilets",icon:e=>l.createElement(p,{location:e}),popup:e=>l.createElement(E,{location:e}),fetchData:()=>x("toilets")},defib:{label:"Defibrillators",icon:e=>l.createElement(g,{location:e}),popup:e=>l.createElement(k,{location:e}),fetchData:()=>x("defibrillators")},busStop:{label:"Bus stops",icon:e=>l.createElement(w,{location:e}),popup:e=>l.createElement(v,{location:e}),fetchData:()=>x("bus/stops")},carpark:{label:"Car parks",icon:e=>l.createElement(C,{location:e}),popup:e=>l.createElement(B,{location:e}),fetchData:()=>x("carparks")}};async function x(e){try{const t="https://data-api.glitch.je/v1",a=await fetch(`${t}/${e}`);if(!a.ok)throw new Error("Response was not ok");const l=await a.json();return l?.results}catch(t){throw console.error(`Failed to fetch data for route ${e}: ${t.message}`),t}}},284:(e,t,a)=>{a.r(t),a.d(t,{default:()=>d});var l=a(6540),n=a(4586),r=a(5549),c=a(1963),i=a(53);const o={container:"container_OoCm",sectionTitle:"sectionTitle_c3gX",parkingSpacesDates:"parkingSpacesDates_S8JW",parkingSpaceDateItem:"parkingSpaceDateItem_ZgHW",failedLoadingSpaces:"failedLoadingSpaces_yjj_"};var s=a(4731),p=a(2022),m=a(7861),u=a(8976);function d(){const{siteConfig:e}=(0,n.A)(),[t,a]=(0,l.useState)([]),[p,u]=(0,l.useState)([]),[d,g]=(0,l.useState)(""),[h,f]=(0,l.useState)(!1);(0,l.useEffect)((()=>{if(""!==d){b();let e=setInterval((()=>b()),5e3);return()=>clearInterval(e)}}),[d]),(0,l.useEffect)((()=>{y()}),[]),(0,l.useEffect)((()=>{0!==p.length&&g(p[0])}),[p]);const b=async()=>{f(!1);try{const e=await fetch(`https://data-api.glitch.je/v1/carparks/test-spaces?date=${d}`);a((await e.json()).reverse())}catch(e){console.error("Error fetching carpark spaces:",e),f(!0)}},y=async()=>{f(!1);try{const e=await fetch("https://data-api.glitch.je/v1/carparks/live-spaces/dates");u((await e.json()).results.reverse())}catch(e){console.error("Error fetching carpark spaces:",e),f(!0)}},N=()=>{let e="#";for(let t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e};return l.createElement(r.A,{title:"Examples",description:"Examples of using the data"},l.createElement("main",{className:(0,i.A)("container",o.container)},l.createElement("section",null,l.createElement("h2",{className:o.sectionTitle},"Parking spaces over time"),l.createElement("p",null,"Click a date below to view the spaces on that day."),h?l.createElement("div",{className:o.failedLoadingSpaces},l.createElement("p",null,"Failed to load carpark spaces"),l.createElement("button",{onClick:()=>y()},"Retry")):l.createElement(l.Fragment,null,l.createElement("div",{className:o.parkingSpacesDates},p.map((e=>l.createElement("div",{key:e,className:o.parkingSpaceDateItem,style:{backgroundColor:e===d?"black":"#ececec",color:e===d?"white":"black"},onClick:()=>g(e)},l.createElement("span",null,new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"2-digit"})))))),!!d&&l.createElement("p",{style:{marginTop:"10px",marginBottom:0}},"Showing ",new Date(d).toDateString()),l.createElement(s.N1,{data:(()=>{const e=t.reduce(((e,t)=>{const{name:a,createdAt:l,spaces:n}=t;return e[a]||(e[a]=[]),e[a].push({createdAt:l,spaces:n}),e}),{}),a=Object.keys(e).map((t=>({label:t,data:e[t].map((e=>e.spaces)),borderColor:N(),backgroundColor:"rgba(0,0,0,0)"})));return{labels:Array.from(new Set(t.map((e=>new Date(e.createdAt).toLocaleTimeString())))),datasets:a}})(),options:{plugins:{title:{display:!0,position:"top"},legend:{display:!0,position:"top"},tooltip:{mode:"point",intersect:!1}}}}))),l.createElement(E,{title:"Public Access Defibrillators",item:m.Z.defib},l.createElement("p",null,"Below is all the public access defibrillators around the island. Click on a ",l.createElement("img",{src:"/img/maps/defib.png",height:"15",width:"15"})," icon for more information about that location.")),l.createElement(E,{title:"Car parks",item:m.Z.carpark},l.createElement("p",null,"Below is all the public carparks around the island. Click on a ",l.createElement("img",{src:"/img/maps/carpark.png",height:"15",width:"15"})," icon for more information about that location.")),l.createElement(E,{title:"Recycling centres",item:m.Z.recycling},l.createElement("p",null,"Below is all the recycling centres around the island. Click on a ",l.createElement("img",{src:"/img/maps/recycling.png",height:"15",width:"15"})," icon for more information about that location."),l.createElement(c.A,{type:"tip",title:"Please note"},"Locations are approximate and just refer to the general area")),l.createElement(E,{title:"Public toilets",item:m.Z.toilet},l.createElement("p",null,"Below is all the public toilets around the island. Click on a ",l.createElement("img",{src:"/img/maps/toilet.png",height:"15",width:"15"})," icon for more information about that location.")),l.createElement(E,{title:"Bus stops",item:m.Z.busStop},l.createElement("p",null,"Below is all the bus stops around the island. Click on a ",l.createElement("img",{src:"/img/maps/bus-stop.png",height:"15",width:"15"})," icon for more information about that location.")),l.createElement(E,{title:"Eatsafe ratings",item:m.Z.eatsafe},l.createElement("p",null,"Below is all the businesses with eatsafe ratings around the island. Click on a rating icon for more information about that location."),l.createElement("p",null,"NOTE: Not all businesses have addresses specified and as such are not displayed here."))))}function E(e){return l.createElement("section",{style:{marginTop:"50px"}},l.createElement("h2",{className:o.sectionTitle},e.title),e.children,l.createElement(u.A,{item:e.item}))}p.t1.register(p.PP,p.kc,p.FN,p.No,p.UA,p.hE,p.m_,p.s$)},8272:e=>{e.exports=JSON.parse('{"R":"pk.eyJ1IjoibHVrZWVleWRldiIsImEiOiJjbHI4cjV3MGswYjYzMmp0M3lnaGllcHZhIn0.rBFyu08FWcUHQ2S7YSN0zg"}')}}]);