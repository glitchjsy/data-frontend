"use strict";(self.webpackChunk_glitchjsy_data_frontend=self.webpackChunk_glitchjsy_data_frontend||[]).push([[2465],{2760:(e,t,a)=>{a.d(t,{A:()=>y});var n=a(6540),l=a(2898),r=a(3551),s=a(7559),c=a(3975),o=a(53);const i=[{type:"link",label:"Dashboard",href:"/admin"},{type:"link",label:"Users",href:"/admin/users"},{type:"link",label:"API Keys",href:"/admin/api-keys"}];function d(){return n.createElement("aside",{className:(0,o.A)(s.G.docs.docSidebarContainer,r.A.docSidebarContainer)},n.createElement(c.A,{sidebar:i,path:"/charts",onCollapse:function(){throw new Error("Function not implemented.")},isHidden:!1}))}var m=a(5976),u=a(3042),p=a(7346),E=a(5549);const h={adminHeader:"adminHeader_O0l7"},b={page:"page_zoQh"};function g(){return n.createElement(E.A,{title:"Not authorized"},n.createElement("div",{className:b.page},n.createElement("h1",null,"Not Authorized"),n.createElement("p",null,"You are not authorized to access this page")))}function y(e){let{children:t,title:a,subCategory:r}=e;const[c,i]=(0,n.useState)(!1);(0,n.useEffect)((()=>{b()}),[]);const b=async()=>{try{const e=await fetch("https://data-api.glitch.je/me/session",{credentials:"include"}),t=await e.json();t&&t.user?.siteAdmin?i(!0):i(!1)}catch{i(!1)}};return c?n.createElement(E.A,{title:a},n.createElement("div",{className:h.adminHeader},"Admin Area"),n.createElement("div",{className:l.A.docPage},n.createElement(d,null),n.createElement("main",{className:(0,o.A)(p.A.docMainContainer)},n.createElement("div",{className:(0,o.A)("container","padding-top--md","padding-bottom--lg")},n.createElement("div",{className:m.A.docItemContainer},n.createElement("article",null,n.createElement("nav",{className:u.A.breadcrumbsContainer},n.createElement("ul",{className:"breadcrumbs"},r&&n.createElement("li",{className:"breadcrumbs__item"},n.createElement("a",{className:"breadcrumbs__link"},r)),n.createElement("li",{className:"breadcrumbs__item breadcrumbs__item--active"},n.createElement("span",{className:"breadcrumbs__link"},a),n.createElement("meta",{itemProp:"position",content:"2"})))),n.createElement("div",{className:(0,o.A)(s.G.docs.docMarkdown,"marldown")},t))))))):n.createElement(g,null)}},6061:(e,t,a)=>{a.r(t),a.d(t,{default:()=>v});var n=a(2760),l=a(6540);const r={statsWrapper:"statsWrapper_CmEy"},s={stat:"stat_vpMA",name:"name_X04S",value:"value_qyDm"};function c(e){let{name:t,value:a}=e;return l.createElement("div",{className:s.stat},l.createElement("div",{className:s.name},t),l.createElement("div",{className:s.value},a))}const o={loadingOrFailed:"loadingOrFailed_plEN",loading:"loading_KG5I",failed:"failed_aRGQ",fullscreen:"fullscreen_jaYg",footer:"footer_nezz",toolbarButton:"toolbarButton_eyxn",toolbar:"toolbar_tzZJ",viewTypeWrapper:"viewTypeWrapper_dPNk",datePickerWrapper:"datePickerWrapper_tlEY",spinner:"spinner_JOIq",spin:"spin_cVc5"};var i=a(9386),d=a.n(i),m=(a(1180),a(53)),u=a(8027),p=a(1578);let E=function(e){return e[e.Loading=0]="Loading",e[e.Loaded=1]="Loaded",e[e.Failed=2]="Failed",e}({});function h(e){const[t,a]=(0,l.useState)(!1),[n,r]=(0,l.useState)(!1),s=()=>{r(!0),setTimeout((()=>{r(!1),e.onRetry()}),200)};if(e.state===E.Loading||n)return l.createElement("div",{className:(0,m.A)(o.loadingOrFailed,o.loading)},l.createElement("div",{className:o.spinner}),l.createElement("p",null,"Loading ",e.title," chart..."));if(e.state===E.Failed)return l.createElement("div",{className:(0,m.A)(o.loadingOrFailed,o.failed)},l.createElement("p",null,"Failed to load data for ",e.title," chart"),l.createElement("button",{className:"btn btn-primary",onClick:s},"Retry"));return l.createElement("div",{className:t?o.fullscreen:void 0},l.createElement("div",{className:o.toolbar},e.enableViewMode&&e.viewMode&&e.onViewModeChange&&l.createElement("div",{className:o.viewTypeWrapper},l.createElement("button",{onClick:()=>e.onViewModeChange("all"),disabled:"all"===e.viewMode},"All"),l.createElement("button",{onClick:()=>e.onViewModeChange("monthly"),disabled:"monthly"===e.viewMode},"Monthly"),l.createElement("button",{onClick:()=>e.onViewModeChange("yearly"),disabled:"yearly"===e.viewMode},"Yearly")),e.enableDateControls&&l.createElement("div",{className:o.datePickerWrapper},e.onPrev&&l.createElement("button",{onClick:e.onPrev},"<"),e.onNext&&l.createElement("button",{onClick:e.onNext},">"),e.onDateChange&&l.createElement(d(),{selected:e.selectedDate,onChange:e.onDateChange,dateFormat:e.datePickerIsMonthsOnly?"MMM yyyy":"dd MMM yyyy",showMonthYearPicker:e.datePickerIsMonthsOnly}))),e.children,l.createElement("div",{className:o.footer},l.createElement("button",{className:o.toolbarButton,onClick:()=>a(!t)},t?l.createElement(l.Fragment,null,l.createElement(p.GWt,null)," Exit Fullscreen"):l.createElement(l.Fragment,null,l.createElement(u._AH,null)," Fullscreen")),l.createElement("button",{className:o.toolbarButton,onClick:()=>{const e=document.querySelector("canvas");if(e){const t=document.createElement("a");t.href=e.toDataURL("image/png"),t.download="chart.png",t.click()}}},l.createElement(u.dIn,null)," Save Image")))}var b=a(4731),g=a(2022);function y(){const[e,t]=(0,l.useState)({}),[a,n]=(0,l.useState)(new Date),[r,s]=(0,l.useState)(!1),[c,o]=(0,l.useState)(E.Loading),i=async e=>{try{s(!1);let a="https://data-api.glitch.je/admin/stats/daily-requests";if(e){const t=e.getMonth()+1;a+=`?month=${t}&year=${e.getFullYear()}`}const n=await fetch(a,{credentials:"include"}),l=(await n.json()).results;t(l),s(!0)}catch(a){console.error("Error fetching chart data:",a),s(!1)}};(0,l.useEffect)((()=>{i(a)}),[]),(0,l.useEffect)((()=>{if(r){const a=e.map((e=>e.day)),n=e.map((e=>parseInt(e.total)));t({labels:a,datasets:[{label:"API Requests",data:n,borderColor:"green",backgroundColor:"green",fill:!1,tension:.4}]}),o(E.Loaded)}}),[r]);return l.createElement(h,{title:"API Requests",state:c,onRetry:()=>i(a),enableDateControls:!0,selectedDate:a,datePickerIsMonthsOnly:!0,onDateChange:e=>{e&&(n(e),i(e))},onPrev:()=>{const e=new Date(a);e.setMonth(e.getMonth()-1),n(e),i(e)},onNext:()=>{const e=new Date(a);e.setMonth(e.getMonth()+1),n(e),i(e)}},l.createElement(b.N1,{data:e,options:{responsive:!0,plugins:{legend:{position:"top"},title:{display:!0,text:"API Requests per Day"}},scales:{x:{title:{display:!0,text:"Date"}},y:{title:{display:!0,text:"Requests"},beginAtZero:!0}}}}))}function v(){const[e,t]=(0,l.useState)(""),a=async()=>{try{const e=await fetch("https://data-api.glitch.je/admin/stats",{credentials:"include"}),a=(await e.json()).results;t(a.apiUptime)}catch(e){console.error("Error fetching stats:",e)}};return(0,l.useEffect)((()=>{a();const e=setInterval((()=>a()),1e3);return()=>clearInterval(e)}),[]),l.createElement(n.A,{title:"Dashboard"},l.createElement("h1",null,"Dashboard"),l.createElement("div",{className:r.statsWrapper},l.createElement(c,{name:"API Uptime",value:e})),l.createElement("div",{style:{marginTop:"20px"}},l.createElement(y,null)))}g.t1.register(g.PP,g.kc,g.FN,g.No,g.hE,g.m_,g.s$)}}]);