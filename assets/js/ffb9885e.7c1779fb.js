"use strict";(self.webpackChunk_glitchjsy_data_frontend=self.webpackChunk_glitchjsy_data_frontend||[]).push([[2014],{52760:(e,t,a)=>{a.d(t,{A:()=>A});var n=a(96540),r=a(2898),l=a(93551),c=a(17559),s=a(93975),i=a(20053);const o=[{type:"link",label:"Dashboard",href:"/admin"},{type:"link",label:"Users",href:"/admin/users"},{type:"link",label:"API Keys",href:"/admin/api-keys"}];function d(){return n.createElement("aside",{className:(0,i.A)(c.G.docs.docSidebarContainer,l.A.docSidebarContainer)},n.createElement(s.A,{sidebar:o,path:"/charts",onCollapse:function(){throw new Error("Function not implemented.")},isHidden:!1}))}var m=a(5976),u=a(3042),E=a(37346),p=a(15549);const h={adminHeader:"adminHeader_O0l7"},y={page:"page_zoQh"};function b(){return n.createElement(p.A,{title:"Not authorized"},n.createElement("div",{className:y.page},n.createElement("h1",null,"Not Authorized"),n.createElement("p",null,"You are not authorized to access this page")))}var g=a(99571);function A(e){let{children:t,title:a,subCategory:l}=e;const[s,o]=(0,n.useState)(!1);(0,n.useEffect)((()=>{y()}),[]);const y=async()=>{try{const e=await fetch("https://api.opendata.je/me/session",{credentials:"include"}),t=await e.json();t&&t.user?.siteAdmin?o(!0):o(!1)}catch{o(!1)}};return s?n.createElement(p.A,{title:a},n.createElement("div",{className:h.adminHeader},"Admin Area"),n.createElement("div",{className:r.A.docPage},n.createElement(d,null),n.createElement("main",{className:(0,i.A)(E.A.docMainContainer)},n.createElement("div",{className:(0,i.A)("container","padding-top--md","padding-bottom--lg")},n.createElement("div",{className:m.A.docItemContainer},n.createElement("article",null,n.createElement("nav",{className:u.A.breadcrumbsContainer},n.createElement("ul",{className:"breadcrumbs"},l&&n.createElement("li",{className:"breadcrumbs__item"},n.createElement("a",{className:"breadcrumbs__link"},l)),n.createElement("li",{className:"breadcrumbs__item breadcrumbs__item--active"},n.createElement("span",{className:"breadcrumbs__link"},a),n.createElement("meta",{itemProp:"position",content:"2"})))),n.createElement("div",{className:(0,i.A)(c.G.docs.docMarkdown,"marldown")},t)))))),n.createElement(g.N9,null)):n.createElement(b,null)}},46325:(e,t,a)=>{a.d(t,{A:()=>l});var n=a(58168),r=a(96540);function l(e){let{gap:t,direction:a="row",children:l,...c}=e;return r.createElement("div",(0,n.A)({style:{display:"flex",gap:t,flexDirection:a}},c),l)}},26414:(e,t,a)=>{a.d(t,{A:()=>i});var n=a(58168),r=a(96540),l=a(95293),c=a(20053);const s={button:"button_h_xa",smallerPadding:"smallerPadding_avZr",primary:"primary_UmVR",secondary:"secondary_amWm",danger:"danger_jN6b"};function i(e){let{children:t,variant:a="primary",useSmallerPadding:i,className:o,...d}=e;const{colorMode:m}=(0,l.G)();return r.createElement("button",(0,n.A)({className:(0,c.A)(s.button,s[a],{[s.smallerPadding]:i},o),"data-theme":m},d),t)}},4334:(e,t,a)=>{a.d(t,{b:()=>i});var n=a(96540),r=a(95293);const l={tableWrapper:"tableWrapper_GFu2",table:"table_L05C"};var c=a(26414),s=a(39197);function i(e){let{columns:t,data:a,onReload:i}=e;const{colorMode:o}=(0,r.G)();return n.createElement("div",{className:l.tableWrapper,"data-theme":o},n.createElement("table",{className:l.table},n.createElement("thead",null,n.createElement("tr",null,t.map((e=>n.createElement("th",{key:e.key},e.header))))),n.createElement("tbody",null,a.map((e=>n.createElement("tr",{key:e.id},t.map((t=>n.createElement("td",{key:t.key},t.render?t.render(e):e[t.key])))))))),n.createElement(c.A,{variant:"secondary",useSmallerPadding:!0,onClick:()=>i()},n.createElement(s.BVQ,{style:{marginRight:"6px"}})," Reload"))}},45591:(e,t,a)=>{a.d(t,{A:()=>l});var n=a(96540);const r={formGroup:"formGroup_YCak"};function l(e){return n.createElement("div",{className:r.formGroup},n.createElement("label",null,e.label),e.children)}},39063:(e,t,a)=>{a.d(t,{A:()=>s});var n=a(96540),r=a(20312),l=a.n(r);const c={overlay:"overlay_hsb3",content:"content_L2fA",close:"close_fKGm",title:"title__v93",body:"body_gKmW"};function s(e){let{isOpen:t,onClose:a,title:r,children:s}=e;return n.createElement(l(),{isOpen:t,onRequestClose:a,overlayClassName:c.overlay,className:c.content},n.createElement("button",{className:c.close,onClick:a},"\xd7"),r&&n.createElement("h2",{className:c.title},r),n.createElement("div",{className:c.body},s))}},47751:(e,t,a)=>{a.r(t),a.d(t,{default:()=>y});var n=a(52760),r=a(46325),l=a(26414),c=a(4334),s=a(45591),i=a(39063),o=a(96540);const d={switch:"switch_FejB",slider:"slider_wfHO"};function m(e){let{checked:t,onChange:a,disabled:n}=e;return o.createElement("label",{className:d.switch},o.createElement("input",{type:"checkbox",checked:t,onChange:e=>a(e.target.checked),disabled:n}),o.createElement("span",{className:d.slider}))}var u=a(51107),E=a(98027),p=a(39197),h=a(99571);function y(){const[e,t]=(0,o.useState)([]),[a,s]=(0,o.useState)({}),[i,d]=(0,o.useState)(!1),[m,y]=(0,o.useState)(!1);(0,o.useEffect)((()=>{A(!0)}),[]);const A=async e=>{try{const a=await fetch("https://api.opendata.je/admin/users",{credentials:"include"});t((await a.json()).results),e||(0,h.oR)("Fetched users",{type:"success"})}catch(a){console.error("Error fetching users:",a)}};return o.createElement(n.A,{title:"Users"},o.createElement(u.A,{as:"h1"},"Users"),o.createElement(l.A,{variant:"primary",style:{marginBottom:"20px"},onClick:()=>y(!0)},o.createElement(p.OiG,{style:{marginRight:"8px"}})," Create User"),o.createElement(c.b,{data:e,onReload:()=>A(),columns:[{key:"email",header:"Email"},{key:"createdAt",header:"Joined",render:e=>new Date(e.createdAt).toLocaleDateString("en-GB",{year:"numeric",month:"long",day:"numeric"})},{key:"id",header:"ID",render:e=>e.id},{key:"actions",header:"",render:e=>o.createElement(r.A,{gap:"6px"},o.createElement(l.A,{useSmallerPadding:!0,variant:"secondary",onClick:()=>{s(e),d(!0)}},o.createElement(E.uO9,null)),o.createElement(l.A,{useSmallerPadding:!0,variant:"danger",onClick:()=>(async e=>{try{confirm("Are you sure you want to delete this user?")&&(await fetch(`https://api.opendata.je/admin/users/${e.id}`,{method:"DELETE",credentials:"include"}),window.location.reload())}catch(t){console.error("Error deleting user:",t)}})(e)},o.createElement(p.G02,null)))}]}),o.createElement(b,{isOpen:i,onClose:()=>d(!1),user:a}),o.createElement(g,{isOpen:m,onClose:()=>y(!1)}))}function b(e){let{isOpen:t,onClose:a,user:n}=e;const[c,d]=(0,o.useState)(""),[u,E]=(0,o.useState)(!1);(0,o.useEffect)((()=>{d(n?.email||""),E(Boolean(n?.siteAdmin||!1))}),[t]);return o.createElement(i.A,{isOpen:t,onClose:a,title:"Edit User"},o.createElement("p",null,n?.id),o.createElement(r.A,{direction:"column",gap:"5px",style:{marginBottom:"20px"}},o.createElement(s.A,{label:"Email"},o.createElement("input",{type:"email",value:c,onChange:e=>d(e.target.value)})),o.createElement(s.A,{label:"Site Admin"},o.createElement(m,{checked:u,onChange:e=>E(e)}))),o.createElement(l.A,{variant:"secondary",onClick:()=>(async()=>{try{await fetch(`https://api.opendata.je/admin/users/${n?.id}`,{method:"POST",credentials:"include",body:JSON.stringify({email:c,siteAdmin:u})}),a(),window.location.reload()}catch(e){console.error("Error updating user:",e)}})()},"Update"))}function g(e){let{isOpen:t,onClose:a}=e;const[n,c]=(0,o.useState)(""),[d,u]=(0,o.useState)(""),[E,p]=(0,o.useState)(!1);(0,o.useEffect)((()=>{c(""),u(""),p(!1)}),[t]);return o.createElement(i.A,{isOpen:t,onClose:a,title:"Create User"},o.createElement(r.A,{direction:"column",gap:"6px",style:{marginBottom:"15px"}},o.createElement(s.A,{label:"Email"},o.createElement("input",{type:"email",value:n,onChange:e=>c(e.target.value)})),o.createElement(s.A,{label:"Password"},o.createElement("input",{value:d,type:"password",onChange:e=>u(e.target.value)})),o.createElement(s.A,{label:"Site Admin"},o.createElement(m,{checked:E,onChange:e=>p(e)}))),o.createElement(l.A,{variant:"secondary",onClick:()=>(async()=>{try{await fetch("https://api.opendata.je/admin/users/new",{method:"POST",credentials:"include",body:JSON.stringify({email:n,password:d,siteAdmin:E})}),a(),window.location.reload()}catch(e){console.error("Error creating user:",e)}})()},"Create"))}}}]);