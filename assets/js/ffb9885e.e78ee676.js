"use strict";(self.webpackChunk_glitchjsy_data_frontend=self.webpackChunk_glitchjsy_data_frontend||[]).push([[2014],{52760:(e,t,a)=>{a.d(t,{A:()=>f});var n=a(96540),l=a(2898),r=a(93551),c=a(17559),s=a(93975),i=a(20053);const o=[{type:"link",label:"Dashboard",href:"/admin"},{type:"link",label:"Users",href:"/admin/users"},{type:"link",label:"API Keys",href:"/admin/api-keys"}];function m(){return n.createElement("aside",{className:(0,i.A)(c.G.docs.docSidebarContainer,r.A.docSidebarContainer)},n.createElement(s.A,{sidebar:o,path:"/charts",onCollapse:function(){throw new Error("Function not implemented.")},isHidden:!1}))}var d=a(5976),u=a(3042),E=a(37346),h=a(15549);const p={adminHeader:"adminHeader_O0l7"},b={page:"page_zoQh"};function y(){return n.createElement(h.A,{title:"Not authorized"},n.createElement("div",{className:b.page},n.createElement("h1",null,"Not Authorized"),n.createElement("p",null,"You are not authorized to access this page")))}function f(e){let{children:t,title:a,subCategory:r}=e;const[s,o]=(0,n.useState)(!1);(0,n.useEffect)((()=>{b()}),[]);const b=async()=>{try{const e=await fetch("https://data-api.glitch.je/me/session",{credentials:"include"}),t=await e.json();t&&t.user?.siteAdmin?o(!0):o(!1)}catch{o(!1)}};return s?n.createElement(h.A,{title:a},n.createElement("div",{className:p.adminHeader},"Admin Area"),n.createElement("div",{className:l.A.docPage},n.createElement(m,null),n.createElement("main",{className:(0,i.A)(E.A.docMainContainer)},n.createElement("div",{className:(0,i.A)("container","padding-top--md","padding-bottom--lg")},n.createElement("div",{className:d.A.docItemContainer},n.createElement("article",null,n.createElement("nav",{className:u.A.breadcrumbsContainer},n.createElement("ul",{className:"breadcrumbs"},r&&n.createElement("li",{className:"breadcrumbs__item"},n.createElement("a",{className:"breadcrumbs__link"},r)),n.createElement("li",{className:"breadcrumbs__item breadcrumbs__item--active"},n.createElement("span",{className:"breadcrumbs__link"},a),n.createElement("meta",{itemProp:"position",content:"2"})))),n.createElement("div",{className:(0,i.A)(c.G.docs.docMarkdown,"marldown")},t))))))):n.createElement(y,null)}},45591:(e,t,a)=>{a.d(t,{A:()=>r});var n=a(96540);const l={formGroup:"formGroup_YCak"};function r(e){return n.createElement("div",{className:l.formGroup},n.createElement("label",null,e.label),e.children)}},39063:(e,t,a)=>{a.d(t,{A:()=>s});var n=a(96540),l=a(20312),r=a.n(l);const c={overlay:"overlay_hsb3",content:"content_L2fA",close:"close_fKGm",title:"title__v93",body:"body_gKmW"};function s(e){let{isOpen:t,onClose:a,title:l,children:s}=e;return n.createElement(r(),{isOpen:t,onRequestClose:a,overlayClassName:c.overlay,className:c.content},n.createElement("button",{className:c.close,onClick:a},"\xd7"),l&&n.createElement("h2",{className:c.title},l),n.createElement("div",{className:c.body},s))}},10739:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(52760),l=a(45591),r=a(39063),c=a(51107),s=a(96540);function i(){const[e,t]=(0,s.useState)([]),[a,l]=(0,s.useState)({}),[r,i]=(0,s.useState)(!1),[d,u]=(0,s.useState)(!1);(0,s.useEffect)((()=>{E()}),[]);const E=async()=>{try{const e=await fetch("https://data-api.glitch.je/admin/users",{credentials:"include"});t((await e.json()).results)}catch(e){console.error("Error fetching users:",e)}};return s.createElement(n.A,{title:"Users"},s.createElement(c.A,{as:"h1"},"Users"),s.createElement("button",{className:"btn btn-primary",style:{marginBottom:"20px"},onClick:()=>u(!0)},"Create User"),s.createElement("table",null,s.createElement("thead",null,s.createElement("tr",null,s.createElement("th",null,"Email"),s.createElement("th",null,"Joined"),s.createElement("th",null))),s.createElement("tbody",null,e?.map((e=>s.createElement("tr",{key:e.id},s.createElement("td",null,e.email),s.createElement("td",null,new Date(e.createdAt).toLocaleDateString("en-GB",{year:"numeric",month:"long",day:"numeric"})),s.createElement("td",null,s.createElement("button",{className:"btn btn-primary",style:{marginRight:"10px"},onClick:()=>{l(e),i(!0)}},"Edit"),s.createElement("button",{className:"btn btn-red",onClick:()=>(async e=>{try{confirm("Are you sure you want to delete this user?")&&(await fetch(`https://data-api.glitch.je/admin/users/${e.id}`,{method:"DELETE",credentials:"include"}),window.location.reload())}catch(t){console.error("Error deleting user:",t)}})(e)},"Delete"))))))),s.createElement(o,{isOpen:r,onClose:()=>i(!1),user:a}),s.createElement(m,{isOpen:d,onClose:()=>u(!1)}))}function o(e){let{isOpen:t,onClose:a,user:n}=e;const[c,i]=(0,s.useState)(""),[o,m]=(0,s.useState)(!1);(0,s.useEffect)((()=>{i(n?.email||""),m(Boolean(n?.siteAdmin||!1))}),[t]);return s.createElement(r.A,{isOpen:t,onClose:a,title:"Edit User"},s.createElement("p",null,n?.id),s.createElement(l.A,{label:"Email"},s.createElement("input",{type:"email",value:c,onChange:e=>i(e.target.value)})),s.createElement(l.A,{label:"Site Admin"},s.createElement("input",{type:"checkbox",checked:o,onChange:e=>m(e.target.checked)})),s.createElement("button",{className:"btn",onClick:()=>(async()=>{try{await fetch(`https://data-api.glitch.je/admin/users/${n?.id}`,{method:"POST",credentials:"include",body:JSON.stringify({email:c,siteAdmin:o})}),a(),window.location.reload()}catch(e){console.error("Error updating user:",e)}})()},"Update"))}function m(e){let{isOpen:t,onClose:a}=e;const[n,c]=(0,s.useState)(""),[i,o]=(0,s.useState)(""),[m,d]=(0,s.useState)(!1);(0,s.useEffect)((()=>{c(""),o(""),d(!1)}),[t]);return s.createElement(r.A,{isOpen:t,onClose:a,title:"Create User"},s.createElement(l.A,{label:"Email"},s.createElement("input",{type:"email",value:n,onChange:e=>c(e.target.value)})),s.createElement(l.A,{label:"Password"},s.createElement("input",{value:i,type:"password",onChange:e=>o(e.target.value)})),s.createElement(l.A,{label:"Site Admin"},s.createElement("input",{type:"checkbox",checked:m,onChange:e=>d(e.target.checked)})),s.createElement("button",{className:"btn",onClick:()=>(async()=>{try{await fetch("https://data-api.glitch.je/admin/users/new",{method:"POST",credentials:"include",body:JSON.stringify({email:n,password:i,siteAdmin:m})}),a(),window.location.reload()}catch(e){console.error("Error creating user:",e)}})()},"Create"))}}}]);